<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Payment View</title>
  </head>
  <body>
      <div id="payment-container"></div>
  <script type="text/javascript">!function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=6)}([function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){e.FullscreenReplacedView="fullscreenReplacedView",e.FullscreenShowedOverlay="fullscreenShowedOverlay",e.FullscreenReplacedOverlay="fullscreenReplacedOverlay",e.FullscreenHidOverlay="fullscreenHidOverlay"}(r.PaymentsLibSentAction||(r.PaymentsLibSentAction={})),function(e){e.HeightChanged="heightChanged",e.FullscreenOverlayShown="fullscreenOverlayShown",e.FullscreenOverlayHidden="fullscreenOverlayHidden",e.FullscreenReplaceView="fullscreenReplaceView",e.FullscreenShowOverlay="fullscreenShowOverlay",e.FullscreenReplaceOverlay="fullscreenReplaceOverlay",e.FullscreenHideOverlay="fullscreenHideOverlay"}(r.PaymentsLibReceivedAction||(r.PaymentsLibReceivedAction={})),function(e){e.HandlerLoadedResponse="handlerLoadedResponse",e.HandshakeResponse="handshakeResponse",e.HeightChangedResponse="heightChangedResponse",e.InitializeResponse="initializeResponse",e.LoadResponse="loadResponse",e.AuthorizeResponse="authorizeResponse",e.ReauthorizeResponse="reauthorizeResponse",e.FinalizeResponse="finalizeResponse",e.ErrorResponse="errorResponse",e.LogResponse="logResponse",e.FullscreenReplaceViewResponse="fullscreenReplaceViewResponse",e.FullscreenShowOverlayResponse="fullscreenShowOverlayResponse",e.FullscreenOverlayShownResponse="fullscreenOverlayShownResponse",e.FullscreenReplaceOverlayResponse="fullscreenReplaceOverlayResponse",e.FullscreenHideOverlayResponse="fullscreenHideOverlayResponse",e.FullscreenOverlayHiddenResponse="fullscreenOverlayHiddenResponse"}(r.NativeSentAction||(r.NativeSentAction={})),function(e){e.Handshake="handshake",e.Initialize="initialize",e.Load="load",e.Authorize="authorize",e.Reauthorize="reauthorize",e.Finalize="finalize",e.FullscreenReplacedView="fullscreenReplacedView",e.FullscreenShowedOverlay="fullscreenShowedOverlay",e.FullscreenReplacedOverlay="fullscreenReplacedOverlay",e.FullscreenHidOverlay="fullscreenHidOverlay"}(r.NativeReceivedAction||(r.NativeReceivedAction={})),function(e){e.Initialize="Initialize",e.Load="Load",e.Authorize="Authorize",e.Reauthorize="Reauthorize",e.Finalize="Finalize",e.Unknown="Unknown"}(r.NativeAction||(r.NativeAction={})),function(e){e.JsLibSentOverlayShownInWrongStateError="JsLibSentOverlayShownInWrongStateError",e.JsLibSentOverlayHiddenInWrongStateError="JsLibSentOverlayHiddenInWrongStateError",e.JsLibSentReplaceViewInWrongStateError="JsLibSentReplaceViewInWrongStateError",e.JsLibSentShowOverlayInWrongStateError="JsLibSentShowOverlayInWrongStateError",e.JsLibSentReplaceOverlayInWrongStateError="JsLibSentReplaceOverlayInWrongStateError",e.JsLibSentHideOverlayInWrongStateError="JsLibSentHideOverlayInWrongStateError",e.JsLibSentUnknownFullscreenActionError="JsLibSentUnknownFullscreenActionError",e.SdkSentReplacedViewInWrongStateError="SdkSentReplacedViewInWrongStateError",e.SdkSentShowedOverlayInWrongStateError="SdkSentShowedOverlayInWrongStateError",e.SdkSentReplacedOverlayInWrongStateError="SdkSentReplacedOverlayInWrongStateError",e.SdkSentHidOverlayInWrongStateError="SdkSentHidOverlayInWrongStateError",e.SdkSentUnknownFullscreenActionError="SdkSentUnknownFullscreenActionError"}(r.FullscreenStateControllerError||(r.FullscreenStateControllerError={})),function(e){e.EventNotSupportedError="EventNotSupportedError"}(r.PaymentsLibReceivedError||(r.PaymentsLibReceivedError={})),function(e){e.UnimplementedFullscreenEventsError="UnimplementedFullscreenEventsError",e.UnimplementedNativeActionMethod="UnimplementedSdkActionMethod",e.CantLoadPaymentsLibraryError="CantLoadPaymentsLibraryError",e.InvalidFieldsError="InvalidFieldsError"}(r.LibraryControllerErrors||(r.LibraryControllerErrors={})),function(e){e.ActionIsNull="ActionIsNull",e.ActionIsUndefined="ActionIsUndefined",e.ActionIsEmptyString="ActionIsEmptyString",e.ActionIsWrongType="ActionIsWrongType",e.PayloadIsNull="PayloadIsNull",e.PayloadIsUndefined="PayloadIsUndefined",e.PayloadIsWrongType="PayloadIsWrongType",e.PayloadValueIsWrongType="PayloadValueIsWrongType"}(r.MessageControllerValidationError||(r.MessageControllerValidationError={})),function(e){e.ParsingError="ParsingError",e.ValidationError="ValidationError",e.UnknownActionError="UnknownActionError"}(r.MessageControllerError||(r.MessageControllerError={})),function(e){e.AlreadySentHandshakeError="AlreadySentHandshakeError"}(r.MessageControllerHandshakeError||(r.MessageControllerHandshakeError={})),function(e){e.InitializeBeforeHandshakeError="InitializeBeforeHandshakeError",e.AlreadyInitializedError="AlreadyInitializedError",e.InitializeWithUndefinedTokenError="InitializeWithUndefinedTokenError",e.InitializeWithEmptyTokenError="InitializeWithEmptyTokenError",e.InitializeWithUndefinedReturnUrlError="InitializeWithUndefinedReturnUrlError",e.InitializeWithEmptyReturnUrlError="InitializeWithEmptyReturnUrlError",e.InitializeWithInvalidAppSchemeForReturnUrlError="InitializeWithInvalidAppSchemeForReturnUrlError"}(r.MessageControllerInitializeError||(r.MessageControllerInitializeError={})),function(e){e.LoadBeforeInitializeError="LoadBeforeInitializeError",e.LoadWithUndefinedPMCError="LoadWithUndefinedPMCError",e.LoadWithEmptyPMCError="LoadWithEmptyPMCError",e.LoadWithInvalidSessionDataError="LoadWithInvalidSessionDataError",e.LoadWithNegativePreassessmentError="LoadWithNegativePreassessmentError"}(r.MessageControllerLoadError||(r.MessageControllerLoadError={})),function(e){e.AuthorizeBeforeLoadError="AuthorizeBeforeLoadError",e.AuthorizeWithInvalidSessionDataError="AuthorizeWithInvalidSessionDataError",e.AuthorizeWithUndefinedPMCError="AuthorizeWithUndefinedPMCError",e.AuthorizeWithEmptyPMCError="AuthorizeWithEmptyPMCError",e.AuthorizeWithNegativeAssessmentError="AuthorizeWithNegativeAssessmentError"}(r.MessageControllerAuthorizeError||(r.MessageControllerAuthorizeError={})),function(e){e.ReauthorizeBeforeLoadError="ReauthorizeBeforeLoadError",e.ReauthorizeWithInvalidSessionDataError="ReauthorizeWithInvalidSessionDataError",e.ReauthorizeWithUndefinedPMCError="ReauthorizeWithUndefinedPMCError",e.ReauthorizeWithEmptyPMCError="ReauthorizeWithEmptyPMCError",e.ReauthorizeWithNegativeAssessmentError="ReauthorizeWithNegativeAssessmentError"}(r.MessageControllerReauthorizeError||(r.MessageControllerReauthorizeError={})),function(e){e.FinalizeBeforeLoadError="FinalizeBeforeLoadError",e.FinalizeWithInvalidSessionDataError="FinalizeWithInvalidSessionDataError",e.FinalizeWithUndefinedPMCError="FinalizeWithUndefinedPMCError",e.FinalizeWithEmptyPMCError="FinalizeWithEmptyPMCError",e.FinalizeWithNegativeAssessmentError="FinalizeWithNegativeAssessmentError"}(r.MessageControllerFinalizeErrors||(r.MessageControllerFinalizeErrors={})),function(e){e.FullscreenEventBeforeLoadError="FullscreenEventBeforeLoadError"}(r.MessageControllerFullscreenError||(r.MessageControllerFullscreenError={})),function(e){e.ErrorTitle="error",e.ErrorMessage="message",e.ErrorAction="action",e.ErrorIsPublic="isPublic",e.ErrorIsFatal="isFatal",e.ErrorInvalidFields="invalidFields",e.Direction="direction",e.ValidationErrors="validationErrors"}(r.PayloadField||(r.PayloadField={}))},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(0),o=function(){function e(e,r){this.action=e,this.payload=r||{}}return e.prototype.addFields=function(e){for(var r in e)this.payload[r]=e[r]},e.prototype.getMethod=function(){switch(this.action){case n.NativeReceivedAction.Initialize:case n.NativeSentAction.InitializeResponse:return n.NativeAction.Initialize;case n.NativeReceivedAction.Load:case n.NativeSentAction.LoadResponse:return n.NativeAction.Load;case n.NativeReceivedAction.Authorize:case n.NativeSentAction.AuthorizeResponse:return n.NativeAction.Authorize;case n.NativeReceivedAction.Reauthorize:case n.NativeSentAction.ReauthorizeResponse:return n.NativeAction.Reauthorize;case n.NativeReceivedAction.Finalize:case n.NativeSentAction.FinalizeResponse:return n.NativeAction.Finalize;default:return n.NativeAction.Unknown}},e}();r.Message=o;var i=function(){return function(){}}();r.MessagePayload=i},function(e,r,t){"use strict";var n=this&&this.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t(0),i=function(e){function r(r,t,n,i,a,s,l){var d=e.call(this,l||o.NativeSentAction.ErrorResponse)||this;return d.payload[o.PayloadField.ErrorTitle]=r,d.payload[o.PayloadField.ErrorMessage]=t,d.payload[o.PayloadField.ErrorAction]=n,d.payload[o.PayloadField.ErrorIsPublic]=i.toString(),d.payload[o.PayloadField.ErrorIsFatal]=a.toString(),null!=s&&d.addFields(s),d}return n(r,e),r.prototype.getMethod=function(){return this.payload[o.PayloadField.ErrorAction]},r}(t(1).Message);r.ErrorMessage=i},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,o=t(0),i=t(2),a=t(1);!function(e){e.Gone="GONE",e.JsSentReplaceView="JS_SENT_REPLACE_VIEW",e.SdkSentReplacedView="SDK_SENT_REPLACED_VIEW",e.JsSentShowOverlay="JS_SENT_SHOW_OVERLAY",e.Shown="SHOWN",e.JsSentReplaceOverlay="JS_SENT_REPLACE_OVERLAY",e.SdkSentReplacedOverlay="SDK_SENT_REPLACED_OVERLAY",e.JsSentHideOverlay="JS_SENT_HIDE_OVERLAY"}(n=r.FullscreenState||(r.FullscreenState={}));var s=function(){function e(){this.state=n.Gone,this.usingNewFlow=!1}return e.prototype.handleJsLibraryAction=function(e,r,t){if(e===o.PaymentsLibReceivedAction.FullscreenOverlayShown){if(this.state!==n.Gone&&this.state!==n.Shown)return void this.reportStateError(o.FullscreenStateControllerError.JsLibSentOverlayShownInWrongStateError,e,t);this.state===n.Gone?(this.usingNewFlow=!1,this.state=n.JsSentReplaceView,this.sendActionToNative(o.NativeSentAction.FullscreenReplaceViewResponse,t)):this.state===n.Shown&&this.sendActionToNative(o.NativeSentAction.FullscreenOverlayShownResponse,t)}else if(e===o.PaymentsLibReceivedAction.FullscreenOverlayHidden){if(this.state!==n.Gone&&this.state!==n.Shown)return void this.reportStateError(o.FullscreenStateControllerError.JsLibSentOverlayHiddenInWrongStateError,e,t);this.state===n.Shown?(this.usingNewFlow=!1,this.state=n.JsSentReplaceOverlay,this.sendActionToNative(o.NativeSentAction.FullscreenReplaceOverlayResponse,t)):this.state===n.Gone&&this.sendActionToNative(o.NativeSentAction.FullscreenOverlayHiddenResponse,t)}else if(e===o.PaymentsLibReceivedAction.FullscreenReplaceView){if(this.state!==n.Gone)return void this.reportStateError(o.FullscreenStateControllerError.JsLibSentReplaceViewInWrongStateError,e,t);this.usingNewFlow=!0,this.state=n.JsSentReplaceView,this.sendActionToNative(o.NativeSentAction.FullscreenReplaceViewResponse,t)}else if(e===o.PaymentsLibReceivedAction.FullscreenShowOverlay){if(this.state!==n.SdkSentReplacedView)return void this.reportStateError(o.FullscreenStateControllerError.JsLibSentShowOverlayInWrongStateError,e,t);this.state=n.JsSentShowOverlay,this.sendActionToNative(o.NativeSentAction.FullscreenShowOverlayResponse,t)}else if(e===o.PaymentsLibReceivedAction.FullscreenReplaceOverlay){if(this.state!==n.Shown)return void this.reportStateError(o.FullscreenStateControllerError.JsLibSentReplaceOverlayInWrongStateError,e,t);this.usingNewFlow=!0,this.state=n.JsSentReplaceOverlay,this.sendActionToNative(o.NativeSentAction.FullscreenReplaceOverlayResponse,t)}else if(e===o.PaymentsLibReceivedAction.FullscreenHideOverlay){if(this.state!==n.SdkSentReplacedOverlay)return void this.reportStateError(o.FullscreenStateControllerError.JsLibSentHideOverlayInWrongStateError,e,t);this.state=n.JsSentHideOverlay,this.sendActionToNative(o.NativeSentAction.FullscreenHideOverlayResponse,t)}else{var a=new i.ErrorMessage(o.FullscreenStateControllerError.JsLibSentUnknownFullscreenActionError,"JS Lib sent unrecognized fullscreen action "+e+".",o.NativeAction.Unknown,!1,!0);a.payload.action=e,a.payload.currentState=this.state,t.sendMessage(a)}},e.prototype.handleSdkAction=function(e,r,t){if(e===o.NativeReceivedAction.FullscreenReplacedView){if(this.state!==n.JsSentReplaceView)return void this.reportStateError(o.FullscreenStateControllerError.SdkSentReplacedViewInWrongStateError,e,t);this.state=n.SdkSentReplacedView,this.usingNewFlow?r.performFullscreenAction(t,this,o.PaymentsLibSentAction.FullscreenReplacedView):this.handleJsLibraryAction(o.PaymentsLibReceivedAction.FullscreenShowOverlay,r,t)}else if(e===o.NativeReceivedAction.FullscreenShowedOverlay){if(this.state!==n.JsSentShowOverlay)return void this.reportStateError(o.FullscreenStateControllerError.SdkSentShowedOverlayInWrongStateError,e,t);this.state=n.Shown,this.usingNewFlow?r.performFullscreenAction(t,this,o.PaymentsLibSentAction.FullscreenShowedOverlay):this.handleJsLibraryAction(o.PaymentsLibReceivedAction.FullscreenOverlayShown,r,t)}else if(e===o.NativeReceivedAction.FullscreenReplacedOverlay){if(this.state!==n.JsSentReplaceOverlay)return void this.reportStateError(o.FullscreenStateControllerError.SdkSentReplacedOverlayInWrongStateError,e,t);this.state=n.SdkSentReplacedOverlay,this.usingNewFlow?r.performFullscreenAction(t,this,o.PaymentsLibSentAction.FullscreenReplacedOverlay):this.handleJsLibraryAction(o.PaymentsLibReceivedAction.FullscreenHideOverlay,r,t)}else if(e===o.NativeReceivedAction.FullscreenHidOverlay){if(this.state!==n.JsSentHideOverlay)return void this.reportStateError(o.FullscreenStateControllerError.SdkSentHidOverlayInWrongStateError,e,t);this.state=n.Gone,this.usingNewFlow?r.performFullscreenAction(t,this,o.PaymentsLibSentAction.FullscreenHidOverlay):this.handleJsLibraryAction(o.PaymentsLibReceivedAction.FullscreenOverlayHidden,r,t)}else{var a=new i.ErrorMessage(o.FullscreenStateControllerError.SdkSentUnknownFullscreenActionError,"SDK sent unrecognized fullscreen action "+e+".",o.NativeAction.Unknown,!1,!0);a.payload.action=e,a.payload.currentState=this.state,t.sendMessage(a)}},e.prototype.reportStateError=function(e,r,t){var n=new i.ErrorMessage(e,"Sent action "+r+" in wrong fullscreen state.",o.NativeAction.Unknown,!1,!0);n.payload.action=r,n.payload.currentState=this.state,t.sendMessage(n)},e.prototype.sendActionToNative=function(e,r){r.sendMessage(new a.Message(e))},e}();r.FullscreenStateController=s},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(0),o=t(2),i=t(1),a=function(){function e(){}return e.prototype.performHandshake=function(e,r){var t=document.createElement("script");t.src="https://x.klarnacdn.net/kp/lib/v1/api.js",t.async=!1,t.addEventListener("load",function(){e.sendMessage(new i.Message(n.NativeSentAction.HandshakeResponse)),e.setPerformedHandshake()}),t.addEventListener("error",function(r){e.sendMessage(new o.ErrorMessage(n.LibraryControllerErrors.CantLoadPaymentsLibraryError,"Couldn't load Payments Library: "+r.message,n.NativeAction.Initialize,!1,!0))}),document.head.appendChild(t)},e.prototype.performInitialize=function(e,r,t){var a=this;try{Klarna.Payments.init({client_token:r.clientToken}),Klarna.Payments.on(n.PaymentsLibReceivedAction.HeightChanged,function(r){var t=(r||-1).toString();e.sendMessage(new i.Message(n.NativeSentAction.HeightChangedResponse,{height:t}))}),Klarna.Payments.on(n.PaymentsLibReceivedAction.FullscreenOverlayShown,function(){t.handleJsLibraryAction(n.PaymentsLibReceivedAction.FullscreenOverlayShown,a,e)}),Klarna.Payments.on(n.PaymentsLibReceivedAction.FullscreenOverlayHidden,function(){t.handleJsLibraryAction(n.PaymentsLibReceivedAction.FullscreenOverlayHidden,a,e)}),Klarna.Payments.on(n.PaymentsLibReceivedAction.FullscreenReplaceView,function(){t.handleJsLibraryAction(n.PaymentsLibReceivedAction.FullscreenReplaceView,a,e)}),Klarna.Payments.on(n.PaymentsLibReceivedAction.FullscreenShowOverlay,function(){t.handleJsLibraryAction(n.PaymentsLibReceivedAction.FullscreenShowOverlay,a,e)}),Klarna.Payments.on(n.PaymentsLibReceivedAction.FullscreenReplaceOverlay,function(){t.handleJsLibraryAction(n.PaymentsLibReceivedAction.FullscreenReplaceOverlay,a,e)}),Klarna.Payments.on(n.PaymentsLibReceivedAction.FullscreenHideOverlay,function(){t.handleJsLibraryAction(n.PaymentsLibReceivedAction.FullscreenHideOverlay,a,e)}),e.sendMessage(new i.Message(n.NativeSentAction.InitializeResponse)),e.setPerformedInitialize()}catch(r){if(r.name===n.PaymentsLibReceivedError.EventNotSupportedError){var s=new o.ErrorMessage(n.LibraryControllerErrors.UnimplementedFullscreenEventsError,"This version of the JS Payments Library hasn't implemented support for fullscreen events yet.",n.NativeAction.Initialize,!1,!1);return e.sendMessage(s),e.sendMessage(new i.Message(n.NativeSentAction.InitializeResponse)),void e.setPerformedInitialize()}e.sendMessage(new o.ErrorMessage(r.name,r.message,n.NativeAction.Initialize,!0,!0))}},e.prototype.performLoad=function(e,r,t){try{Klarna.Payments.load({container:r.containerDiv||"#payment-container",payment_method_category:r.paymentMethodCategory},t,function(r){r.show_form?(e.sendMessage(new i.Message(n.NativeSentAction.LoadResponse,{showForm:(!0).toString()})),e.setPerformedLoad()):e.sendMessage(new o.ErrorMessage(n.MessageControllerLoadError.LoadWithNegativePreassessmentError,"Got a negative pre-assessment during load.",n.NativeAction.Load,!0,!0)),r.error&&r.error.invalid_fields&&e.sendMessage(new o.ErrorMessage(n.LibraryControllerErrors.InvalidFieldsError,"Payments Library noted invalid fields.",n.NativeAction.Load,!0,!1,{invalidFields:JSON.stringify(r.error.invalid_fields)}))})}catch(r){e.sendMessage(new o.ErrorMessage(r.name,r.message,n.NativeAction.Load,!0,!0,{}))}},e.prototype.performAuthorize=function(e,r,t){var a={payment_method_category:r.paymentMethodCategory};r.autoFinalize&&(a.auto_finalize="true"===r.autoFinalize);try{Klarna.Payments.authorize(a,t,function(r){if(r.show_form){var t=new i.Message(n.NativeSentAction.AuthorizeResponse,{showForm:(!0).toString(),approved:r.approved.toString()});r.authorization_token&&(t.payload.authorizationToken=r.authorization_token),r.finalize_required&&(t.payload.finalizeRequired=r.finalize_required.toString()),e.sendMessage(t)}else{t=new o.ErrorMessage(n.MessageControllerAuthorizeError.AuthorizeWithNegativeAssessmentError,"Got a negative assessment during authorize.",n.NativeAction.Authorize,!0,!0);e.sendMessage(t)}r.error&&r.error.invalid_fields&&e.sendMessage(new o.ErrorMessage(n.LibraryControllerErrors.InvalidFieldsError,"Payments Library noted invalid fields.",n.NativeAction.Load,!0,!1,{invalidFields:JSON.stringify(r.error.invalid_fields)}))})}catch(r){e.sendMessage(new o.ErrorMessage(r.name,r.message,n.NativeAction.Authorize,!0,!0,{}))}},e.prototype.performReauthorize=function(e,r,t){try{Klarna.Payments.reauthorize({payment_method_category:r.paymentMethodCategory},t,function(r){if(r.show_form){var t=new i.Message(n.NativeSentAction.ReauthorizeResponse,{showForm:(!0).toString(),approved:r.approved.toString()});r.authorization_token&&(t.payload.authorizationToken=r.authorization_token),e.sendMessage(t)}else{t=new o.ErrorMessage(n.MessageControllerReauthorizeError.ReauthorizeWithNegativeAssessmentError,"Got a negative assessment during reauthorize.",n.NativeAction.Reauthorize,!0,!0);e.sendMessage(t)}r.error&&r.error.invalid_fields&&e.sendMessage(new o.ErrorMessage(n.LibraryControllerErrors.InvalidFieldsError,"Payments Library noted invalid fields.",n.NativeAction.Reauthorize,!0,!1,{invalidFields:JSON.stringify(r.error.invalid_fields)}))})}catch(r){e.sendMessage(new o.ErrorMessage(r.name,r.message,n.NativeAction.Reauthorize,!0,!0,{}))}},e.prototype.performFinalize=function(e,r,t){try{Klarna.Payments.finalize({payment_method_category:r.paymentMethodCategory},t,function(r){if(r.show_form){var t=new i.Message(n.NativeSentAction.FinalizeResponse,{showForm:(!0).toString(),approved:r.approved.toString()});r.authorization_token&&(t.payload.authorizationToken=r.authorization_token),e.sendMessage(t)}else{t=new o.ErrorMessage(n.MessageControllerFinalizeErrors.FinalizeWithNegativeAssessmentError,"Got a negative assessment during finalize.",n.NativeAction.Finalize,!0,!0);e.sendMessage(t)}r.error&&r.error.invalid_fields&&e.sendMessage(new o.ErrorMessage(n.LibraryControllerErrors.InvalidFieldsError,"Payments Library noted invalid fields.",n.NativeAction.Finalize,!0,!1,{invalidFields:JSON.stringify(r.error.invalid_fields)}))})}catch(r){e.sendMessage(new o.ErrorMessage(r.name,r.message,n.NativeAction.Finalize,!0,!0,{}))}},e.prototype.performFullscreenAction=function(e,r,t){try{null!=Klarna.Payments.nativeAction?Klarna.Payments.nativeAction({action:t}):e.sendMessage(new o.ErrorMessage(n.LibraryControllerErrors.UnimplementedNativeActionMethod,"This version of the JS Payments Library hasn't implemented support for the 'sdkAction' method yet.",n.NativeAction.Unknown,!1,!0))}catch(r){e.sendMessage(new o.ErrorMessage(r.name,r.message,n.NativeAction.Unknown,!0,!0))}},e}();r.LibraryController=a},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){e.Incoming="incoming",e.Outgoing="outgoing"}(r.MessageDirection||(r.MessageDirection={}))},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),t(7);var n=t(0),o=t(3),i=t(4),a=t(12),s=t(1),l=t(14);!function(){var e=l.Native.getMessageHandler()||l.Empty.getMessageHandler();window.handler=new a.MessageController(e,new i.LibraryController,new o.FullscreenStateController)}(),window.addEventListener("getHandler",function(e){e.detail.completion(window.handler)}),window.handler.sendMessage(new s.Message(n.NativeSentAction.HandlerLoadedResponse,{}))},function(e,r,t){var n=t(8);"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};t(10)(n,o);n.locals&&(e.exports=n.locals)},function(e,r,t){(e.exports=t(9)(!1)).push([e.i,"* {\n    margin: 0;\n    padding: 0;\n    font-family: sans-serif;\n}",""])},function(e,r){e.exports=function(e){var r=[];return r.toString=function(){return this.map(function(r){var t=function(e,r){var t=e[1]||"",n=e[3];if(!n)return t;if(r&&"function"==typeof btoa){var o=function(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}(n),i=n.sources.map(function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"});return[t].concat(i).concat([o]).join("\n")}return[t].join("\n")}(r,e);return r[2]?"@media "+r[2]+"{"+t+"}":t}).join("")},r.i=function(e,t){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(n[i]=!0)}for(o=0;o<e.length;o++){var a=e[o];"number"==typeof a[0]&&n[a[0]]||(t&&!a[2]?a[2]=t:t&&(a[2]="("+a[2]+") and ("+t+")"),r.push(a))}},r}},function(e,r,t){var n={},o=function(e){var r;return function(){return void 0===r&&(r=e.apply(this,arguments)),r}}(function(){return window&&document&&document.all&&!window.atob}),i=function(e){var r={};return function(e,t){if("function"==typeof e)return e();if(void 0===r[e]){var n=function(e,r){return r?r.querySelector(e):document.querySelector(e)}.call(this,e,t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}r[e]=n}return r[e]}}(),a=null,s=0,l=[],d=t(11);function c(e,r){for(var t=0;t<e.length;t++){var o=e[t],i=n[o.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](o.parts[a]);for(;a<o.parts.length;a++)i.parts.push(y(o.parts[a],r))}else{var s=[];for(a=0;a<o.parts.length;a++)s.push(y(o.parts[a],r));n[o.id]={id:o.id,refs:1,parts:s}}}}function u(e,r){for(var t=[],n={},o=0;o<e.length;o++){var i=e[o],a=r.base?i[0]+r.base:i[0],s={css:i[1],media:i[2],sourceMap:i[3]};n[a]?n[a].parts.push(s):t.push(n[a]={id:a,parts:[s]})}return t}function h(e,r){var t=i(e.insertInto);if(!t)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=l[l.length-1];if("top"===e.insertAt)n?n.nextSibling?t.insertBefore(r,n.nextSibling):t.appendChild(r):t.insertBefore(r,t.firstChild),l.push(r);else if("bottom"===e.insertAt)t.appendChild(r);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=i(e.insertAt.before,t);t.insertBefore(r,o)}}function p(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var r=l.indexOf(e);r>=0&&l.splice(r,1)}function v(e){var r=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var n=function(){0;return t.nc}();n&&(e.attrs.nonce=n)}return f(r,e.attrs),h(e,r),r}function f(e,r){Object.keys(r).forEach(function(t){e.setAttribute(t,r[t])})}function y(e,r){var t,n,o,i;if(r.transform&&e.css){if(!(i=r.transform(e.css)))return function(){};e.css=i}if(r.singleton){var l=s++;t=a||(a=v(r)),n=E.bind(null,t,l,!1),o=E.bind(null,t,l,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(t=function(e){var r=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",f(r,e.attrs),h(e,r),r}(r),n=function(e,r,t){var n=t.css,o=t.sourceMap,i=void 0===r.convertToAbsoluteUrls&&o;(r.convertToAbsoluteUrls||i)&&(n=d(n));o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var a=new Blob([n],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}.bind(null,t,r),o=function(){p(t),t.href&&URL.revokeObjectURL(t.href)}):(t=v(r),n=function(e,r){var t=r.css,n=r.media;n&&e.setAttribute("media",n);if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}.bind(null,t),o=function(){p(t)});return n(e),function(r){if(r){if(r.css===e.css&&r.media===e.media&&r.sourceMap===e.sourceMap)return;n(e=r)}else o()}}e.exports=function(e,r){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(r=r||{}).attrs="object"==typeof r.attrs?r.attrs:{},r.singleton||"boolean"==typeof r.singleton||(r.singleton=o()),r.insertInto||(r.insertInto="head"),r.insertAt||(r.insertAt="bottom");var t=u(e,r);return c(t,r),function(e){for(var o=[],i=0;i<t.length;i++){var a=t[i];(s=n[a.id]).refs--,o.push(s)}e&&c(u(e,r),r);for(i=0;i<o.length;i++){var s;if(0===(s=o[i]).refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete n[s.id]}}}};var g=function(){var e=[];return function(r,t){return e[r]=t,e.filter(Boolean).join("\n")}}();function E(e,r,t,n){var o=t?"":n.css;if(e.styleSheet)e.styleSheet.cssText=g(r,o);else{var i=document.createTextNode(o),a=e.childNodes;a[r]&&e.removeChild(a[r]),a.length?e.insertBefore(i,a[r]):e.appendChild(i)}}},function(e,r){e.exports=function(e){var r="undefined"!=typeof window&&window.location;if(!r)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var t=r.protocol+"//"+r.host,n=t+r.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,r){var o,i=r.trim().replace(/^"(.*)"$/,function(e,r){return r}).replace(/^'(.*)'$/,function(e,r){return r});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?e:(o=0===i.indexOf("//")?i:0===i.indexOf("/")?t+i:n+i.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")})}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(0),o=t(2),i=t(1),a=t(5),s=t(13),l=t(3),d=t(4),c=function(){function e(e,r,t){void 0===r&&(r=new d.LibraryController),void 0===t&&(t=new l.FullscreenStateController),this._performedHandshake=!1,this._performedInitialize=!1,this._performedLoad=!1,this.msgReceiver=e,this.libController=r,this.fsStateController=t}return e.prototype.receiveMessage=function(e){try{var r=JSON.parse(e),t=this.validateMessage(r,a.MessageDirection.Incoming);if(t.success){var s=new i.Message(r.action,r.payload);this.handleMessage(s)}else this.sendMessage(this.createValidationErrorMessage(t,n.NativeAction.Unknown))}catch(e){this.sendMessage(new o.ErrorMessage(n.MessageControllerError.ParsingError,"Error parsing message into JSON.",n.NativeAction.Unknown,!1,!0,{},n.NativeSentAction.ErrorResponse))}},e.prototype.validateMessage=function(e,r){var t=new s.MessageValidation;for(var o in t.direction=r,null===e.action&&(t.success=!1,t.errors.push(n.MessageControllerValidationError.ActionIsNull)),void 0===e.action&&(t.success=!1,t.errors.push(n.MessageControllerValidationError.ActionIsUndefined)),""===e.action&&(t.success=!1,t.errors.push(n.MessageControllerValidationError.ActionIsEmptyString)),"string"!=typeof e.action&&(t.success=!1,t.errors.push(n.MessageControllerValidationError.ActionIsWrongType)),null===e.payload&&(t.success=!1,t.errors.push(n.MessageControllerValidationError.PayloadIsNull)),void 0===e.payload&&(t.success=!1,t.errors.push(n.MessageControllerValidationError.PayloadIsUndefined)),("object"!=typeof e.payload||Array.isArray(e.payload))&&(t.success=!1,t.errors.push(n.MessageControllerValidationError.PayloadIsWrongType)),e.payload){"string"!=typeof e.payload[o]&&(t.success=!1,t.errors.push(n.MessageControllerValidationError.PayloadValueIsWrongType))}return t},e.prototype.handleMessage=function(e){if(e.action===n.NativeReceivedAction.Handshake){if(this._performedHandshake)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerHandshakeError.AlreadySentHandshakeError,"Already sent a handshake signal.",n.NativeAction.Unknown,!1,!0));this.libController.performHandshake(this,e.payload)}else if(e.action===n.NativeReceivedAction.Initialize){if(!this._performedHandshake)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerInitializeError.InitializeBeforeHandshakeError,"Called initialize before handshake.",n.NativeAction.Initialize,!1,!0));if(this._performedInitialize)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerInitializeError.AlreadyInitializedError,"Already called initialize.",n.NativeAction.Initialize,!1,!1));if(void 0===e.payload.clientToken)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerInitializeError.InitializeWithUndefinedTokenError,"Called initialize with no clientToken.",n.NativeAction.Initialize,!1,!0));if(0===e.payload.clientToken.length)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerInitializeError.InitializeWithEmptyTokenError,"Called initialize with empty clientToken.",n.NativeAction.Initialize,!0,!1));if(void 0===e.payload.returnUrl)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerInitializeError.InitializeWithUndefinedReturnUrlError,"Called initialize with no returnUrl.",n.NativeAction.Initialize,!1,!0));if(0===e.payload.returnUrl.length)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerInitializeError.InitializeWithEmptyReturnUrlError,"Called initialize with empty returnUrl.",n.NativeAction.Initialize,!0,!1));if(!new RegExp(/^\w+[\w-\+\.]*:\/\/.*$/).test(e.payload.returnUrl))return void this.sendMessage(new o.ErrorMessage(n.MessageControllerInitializeError.InitializeWithInvalidAppSchemeForReturnUrlError,"Called initialize with invalid app scheme for returnUrl.",n.NativeAction.Initialize,!0,!1));this.libController.performInitialize(this,e.payload,this.fsStateController)}else if(e.action===n.NativeReceivedAction.Load){if(!this._performedInitialize)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerLoadError.LoadBeforeInitializeError,"Called load before initialize.",n.NativeAction.Load,!1,!1));if(void 0===e.payload.paymentMethodCategory)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerLoadError.LoadWithUndefinedPMCError,"Called load with no paymentMethodCategory.",n.NativeAction.Load,!1,!0));if(0===e.payload.paymentMethodCategory.length)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerLoadError.LoadWithEmptyPMCError,"Called load with empty paymentMethodCategory.",n.NativeAction.Load,!1,!1));var r=null;if(void 0!==e.payload.sessionData)try{r=JSON.parse(e.payload.sessionData)}catch(e){return void this.sendMessage(new o.ErrorMessage(n.MessageControllerLoadError.LoadWithInvalidSessionDataError,"Called load with invalid sessionData. "+e.message,n.NativeAction.Load,!0,!1))}this.libController.performLoad(this,e.payload,r)}else if(e.action===n.NativeReceivedAction.Authorize){if(!this._performedLoad)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerAuthorizeError.AuthorizeBeforeLoadError,"Called authorize before load.",n.NativeAction.Authorize,!1,!1));if(void 0===e.payload.paymentMethodCategory)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerAuthorizeError.AuthorizeWithUndefinedPMCError,"Called authorize with no paymentMethodCategory.",n.NativeAction.Load,!1,!0));if(0===e.payload.paymentMethodCategory.length)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerAuthorizeError.AuthorizeWithEmptyPMCError,"Called authorize with empty paymentMethodCategory.",n.NativeAction.Load,!1,!1));r=null;if(void 0!==e.payload.sessionData)try{r=JSON.parse(e.payload.sessionData)}catch(e){return void this.sendMessage(new o.ErrorMessage(n.MessageControllerAuthorizeError.AuthorizeWithInvalidSessionDataError,"Called authorize with invalid sessionData."+e.message,n.NativeAction.Authorize,!0,!1))}this.libController.performAuthorize(this,e.payload,r)}else if(e.action===n.NativeReceivedAction.Reauthorize){if(!this._performedLoad)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerReauthorizeError.ReauthorizeBeforeLoadError,"Called reauthorize before load.",n.NativeAction.Reauthorize,!0,!1));if(void 0===e.payload.paymentMethodCategory)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerReauthorizeError.ReauthorizeWithUndefinedPMCError,"Called reauthorize with no paymentMethodCategory.",n.NativeAction.Load,!1,!0));if(0===e.payload.paymentMethodCategory.length)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerReauthorizeError.ReauthorizeWithEmptyPMCError,"Called reauthorize with empty paymentMethodCategory.",n.NativeAction.Load,!1,!1));r=null;if(void 0!==e.payload.sessionData)try{r=JSON.parse(e.payload.sessionData)}catch(e){return void this.sendMessage(new o.ErrorMessage(n.MessageControllerReauthorizeError.ReauthorizeWithInvalidSessionDataError,"Called reauthorize with invalid sessionData."+e.message,n.NativeAction.Reauthorize,!0,!1))}this.libController.performReauthorize(this,e.payload,r)}else if(e.action===n.NativeReceivedAction.Finalize){if(!this._performedLoad)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerFinalizeErrors.FinalizeBeforeLoadError,"Called finalize before load.",n.NativeAction.Finalize,!0,!1));if(void 0===e.payload.paymentMethodCategory)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerFinalizeErrors.FinalizeWithUndefinedPMCError,"Called finalize with no paymentMethodCategory.",n.NativeAction.Load,!1,!0));if(0===e.payload.paymentMethodCategory.length)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerFinalizeErrors.FinalizeWithEmptyPMCError,"Called finalize with empty paymentMethodCategory.",n.NativeAction.Load,!1,!1));r=null;if(void 0!==e.payload.sessionData)try{r=JSON.parse(e.payload.sessionData)}catch(e){return void this.sendMessage(new o.ErrorMessage(n.MessageControllerFinalizeErrors.FinalizeWithInvalidSessionDataError,"Called finalize with invalid sessionData."+e.message,n.NativeAction.Finalize,!0,!1))}this.libController.performFinalize(this,e.payload,r)}else if(e.action===n.NativeReceivedAction.FullscreenReplacedView||e.action===n.NativeReceivedAction.FullscreenShowedOverlay||e.action===n.NativeReceivedAction.FullscreenReplacedOverlay||e.action===n.NativeReceivedAction.FullscreenHidOverlay){if(!this._performedLoad)return void this.sendMessage(new o.ErrorMessage(n.MessageControllerFullscreenError.FullscreenEventBeforeLoadError,"Called a fullscreen signal before load.",n.NativeAction.Unknown,!1,!0));this.fsStateController.handleSdkAction(e.action,this.libController,this)}else this.sendMessage(new o.ErrorMessage(n.MessageControllerError.UnknownActionError,"Message action was not recognized: "+e.action,n.NativeAction.Unknown,!1,!0))},e.prototype.createValidationErrorMessage=function(e,r){var t={};return t[n.PayloadField.Direction]=e.direction,t[n.PayloadField.ValidationErrors]=JSON.stringify(e.errors),new o.ErrorMessage(n.MessageControllerError.ValidationError,"Error validating message.",r,!1,!0,t)},e.prototype.sendMessage=function(e){var r=this.validateMessage(e,a.MessageDirection.Outgoing);if(r.success){var t=JSON.stringify(e);this.msgReceiver.postMessage(t)}else this.sendMessage(this.createValidationErrorMessage(r,e instanceof o.ErrorMessage?e.getMethod():n.NativeAction.Unknown))},e.prototype.setPerformedHandshake=function(){this._performedHandshake=!0},e.prototype.setPerformedInitialize=function(){this._performedInitialize=!0},e.prototype.setPerformedLoad=function(){this._performedLoad=!0},Object.defineProperty(e.prototype,"performedHandshake",{get:function(){return this._performedHandshake},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"performedInitialize",{get:function(){return this._performedInitialize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"performedLoad",{get:function(){return this._performedLoad},enumerable:!0,configurable:!0}),e}();r.MessageController=c},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(5),o=function(){return function(){this.success=!0,this.direction=n.MessageDirection.Incoming,this.errors=[]}}();r.MessageValidation=o},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.postMessage=function(e){},e}();r.EmptyMessageHandler=n,function(e){e.getMessageHandler=function(){var e=window;return e.webkit&&e.webkit.messageHandlers&&e.webkit.messageHandlers.JSBridge||e.JSBridge||null}}(r.Native||(r.Native={})),function(e){e.getMessageHandler=function(){return new n}}(r.Empty||(r.Empty={}))}]);</script></body>
</html>
